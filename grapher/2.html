<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Framework7 — Sheet minimale</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/framework7@8.3.4/framework7-bundle.min.css" />
  <style>
    /* minimal: ensure compact step is visible (not 0px) */
    #my-sheet { height: auto; }
    #my-sheet .sheet-modal-swipe-step { min-height: 80px; }
    #debug {
      position: fixed; bottom: 8px; right: 8px; z-index: 99999;
      background: rgba(0,0,0,.7); color: #fff; padding: 6px 8px; border-radius: 6px;
      font: 12px/1.2 ui-monospace,Menlo,Consolas,monospace;
    }
    noscript { display:block; background:#fee; color:#900; padding:8px; border:1px solid #f99; }
  </style>
</head>
<body>
<noscript>JavaScript est désactivé. Active-le pour voir la sheet.</noscript>

<div id="app">
  <div class="view view-main view-init" data-url="/">
    <div class="page">
      <div class="navbar">
        <div class="navbar-bg"></div>
        <div class="navbar-inner">
          <div class="title">Sheet minimale</div>
          <div class="right">
            <!-- Auto-handled by F7 (no JS needed) -->
            <a href="#" class="link sheet-open" data-sheet="#my-sheet">Ouvrir</a>
          </div>
        </div>
      </div>
      <div class="page-content">
        <div class="block">
          <p>Démo minimale. Tu peux ouvrir la sheet via :</p>
          <p><a href="#" class="button button-fill sheet-open" data-sheet="#my-sheet">Ouvrir la sheet</a></p>
          <p>Sinon, elle s’ouvrira en compact automatiquement au chargement.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Sheet minimale (auto-initialisée) -->
  <div class="sheet-modal sheet-init" id="my-sheet"
       data-swipe-to-step="true"
       data-swipe-to-close="false"
       data-backdrop="true">
    <div class="sheet-modal-inner">
      <!-- zone visible à l’état compact -->
      <div class="sheet-modal-swipe-step">
        <div class="block no-margin">
          <p class="no-margin text-color-gray">Étape compacte — glisse vers le haut pour agrandir ⤴︎</p>
        </div>
      </div>
      <!-- contenu visible en step ouvert -->
      <div class="block">
        <p>Contenu plein écran. Glisse vers le bas pour revenir au compact.</p>
      </div>
    </div>
  </div>
</div>

<div id="debug" style="display:none">debug…</div>

<script src="https://cdn.jsdelivr.net/npm/framework7@8.3.4/framework7-bundle.min.js"></script>
<script>
  // Surface any JS error to the page (so we SEE it)
  window.onerror = function(msg, url, line, col, err){
    const d = document.getElementById('debug');
    d.style.display = 'block';
    d.textContent = 'JS error: ' + msg;
  };

  (function start(){
    if (!window.Framework7) {
      alert('Framework7 ne s’est pas chargé (CDN bloqué ?).');
      const d = document.getElementById('debug');
      d.style.display = 'block';
      d.textContent = 'F7 introuvable';
      return;
    }

    const app = new Framework7({
      el: '#app',
      on: {
        init() {
          const dbg = document.getElementById('debug');
          dbg.style.display = 'block';
          dbg.textContent = 'F7 OK — init';

          // Get the auto-initialized sheet instance and force compact-open on load
          const sheet = app.sheet.get('#my-sheet');
          if (!sheet) {
            dbg.textContent = 'Sheet non trouvée';
            return;
          }
          sheet.on('opened', () => dbg.textContent = 'Sheet ouverte');
          sheet.on('stepClose', () => dbg.textContent = 'Sheet compact');
          sheet.on('stepOpen', () => dbg.textContent = 'Sheet plein écran');

          // Open then collapse to compact so it's visible by default
          sheet.open(false);
          sheet.stepClose(false);
        }
      }
    });
  }());
</script>
</body>
</html>
