<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>F7 Demo — Sheet push + 2 étapes</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/framework7@8.3.4/framework7-bundle.min.css" />
  <style>
    .demo-text { max-width: 960px; margin: 0 auto; }
    /* Requis par swipe-to-step pour que le step prenne la taille du contenu */
    .demo-sheet { height: auto; }
    .swipe-handler {
      height: 20px; display: flex; align-items: center; justify-content: center; cursor: ns-resize;
    }
    .swipe-handler::before {
      content: ""; width: 36px; height: 4px; border-radius: 2px;
      background: var(--f7-text-muted); opacity: .6;
    }
    .sheet-content { padding-bottom: calc(env(safe-area-inset-bottom, 0) + 12px); }
    .sheet-compact-block { margin-top: 8px; }
  </style>
</head>
<body>
  <div id="app">
    <div class="view view-main view-init ios-edges" data-url="/">
      <div class="page">
        <div class="navbar">
          <div class="navbar-bg"></div>
          <div class="navbar-inner">
            <div class="title">Démo Sheet — 2 étapes</div>
          </div>
        </div>
        <div class="page-content">
          <div class="block block-strong demo-text">
            <p><b>Page de démonstration</b></p>
            <p>La sheet en bas est <b>toujours visible</b> (état compact). Tire le handle vers le haut pour le <b>plein écran</b> (push view), vers le bas pour replier.</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit…</p>
          </div>
        </div>
      </div>
    </div>

    <!-- SHEET MODAL -->
    <div class="sheet-modal sheet-modal-push demo-sheet" id="sheet-demo">
      <div class="swipe-handler"></div>
      <div class="sheet-modal-inner">
        <!-- Zone VISIBLE à l’état compact -->
        <div class="sheet-modal-swipe-step">
          <div class="block sheet-compact-block">
            <p class="text-color-gray no-margin">État compact — toujours visible. Glisse pour agrandir ⤴︎</p>
            <div class="list inset">
              <ul>
                <li>
                  <div class="item-content">
                    <div class="item-inner">
                      <div class="item-title">Résumé A</div><div class="item-after">OK</div>
                    </div>
                  </div>
                </li>
                <li>
                  <div class="item-content">
                    <div class="item-inner">
                      <div class="item-title">Résumé B</div><div class="item-after">42</div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Contenu révélé en plein écran -->
        <div class="block sheet-content">
          <p class="text-color-gray">Contenu plein écran</p>
          <p>Pellentesque at sapien urna. Vestibulum accumsan nibh non eleifend tristique…</p>
          <p>Curabitur nec risus justo. Integer vitae arcu non massa finibus faucibus…</p>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/framework7@8.3.4/framework7-bundle.min.js"></script>
  <script>
    // IMPORTANT: on ouvre la sheet dans on.init pour ne pas rater l'événement
    const app = new Framework7({
      el: '#app',
      name: 'DemoSheet2Steps',
      theme: 'auto',
      sheet: {
        closeByBackdropClick: false,
        closeByOutsideClick: false,
      },
      on: {
        init() {
          const sheet = app.sheet.create({
            el: '#sheet-demo',
            swipeToStep: true,             // 2 états (compact / plein écran)
            swipeToClose: false,           // jamais de fermeture complète
            swipeHandler: '.swipe-handler',
            push: true,                    // push view quand plein écran
            backdrop: true,                // backdrop en plein écran
          });

          // Ouvre la sheet et force l’état compact pour qu’elle soit visible par défaut
          sheet.open(false);     // sans animation (évite le flash)
          sheet.stepClose(false);

          // Interdit toute fermeture complète (ESC/backdrop/programmatique)
          sheet.on('close', () => {
            sheet.open(false);
            sheet.stepClose(false);
          });
        },
      },
    });
  </script>
</body>
</html>
